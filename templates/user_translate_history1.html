<!DOCTYPE html>
<html lang="ja">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Translate Tool</title>
    <link rel="stylesheet" href="/static/plugins/bootstrap-3.4.1/bootstrap-3.4.1-dist/css/bootstrap.css">
    <link rel="stylesheet" href="/static/plugins/font-awesome-4.7.0/font-awesome-4.7.0/css/font-awesome.min.css">
    <script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.8/clipboard.min.js"></script>

    <style>
        .navbar {
            border-radius: 0;
        }

        .navbar-brand img {
            position: relative;
            bottom: 9px;
            background: #808080;
        }

        .navbar-brand {
            line-height: 32px;
        }

        .navbar-nav > li > a {
            line-height: 32px;
        }

        ul {
            list-style: none;
            display: flex;
            justify-content: space-between;
            padding: 0;
        }

        li {
            margin-right: 20px;
            font-weight: bold;
        }

        select, input {
            padding: 5px;
            border: 1px solid #ccc;
            border-radius: 5px;
        }

        button {
            background-color: #007bff;
            color: #fff;
            padding: 6px 20px;
            border: none;
            cursor: pointer;
            border-radius: 6px;
        }

        th, td {
            padding: 8px;
            text-align: center;
        }

        #pagination {
            text-align: center;
            margin-top: 20px;
        }
    </style>

    <!-- ... å…¶ä»–å¤´éƒ¨å†…å®¹ ... -->
    <script>
        // è¯­è¨€æ˜ å°„å­—å…¸
        const languageMapping = {
            'æ—¥æœ¬èª': 1,
            'English': 2,
            'ä¸­æ–‡': 3,
            'á€”á€ºá€™á€¬á€˜á€¬á€á€¬': 4,
            // æ·»åŠ å…¶ä»–è¯­è¨€æ˜ å°„
        };
    </script>


</head>

<body>
<!-- å¯¼èˆªæ å†…å®¹ -->
<div class="container">
    <div class="container">
        <ol class="breadcrumb">
            <!-- é¢åŒ…å±‘å¯¼èˆª -->
            <li><a href="#">C-Tream-APP</a></li>
            <li><a href="#">å±¥æ­´ç”»é¢</a></li>
            <li class="active">SHOW</li>
        </ol>

        <div class="select">
            <ul>
                <li>
                    <div class="btn-group">
                        <button type="button" class="btn btn-info" id="inputLanguageButton">å…¥åŠ›è¨€èª</button>
                        <button type="button" class="btn btn-info dropdown-toggle" data-toggle="dropdown"
                                aria-haspopup="true" aria-expanded="false">
                            <span class="caret"></span>
                            <span class="sr-only">Toggle Dropdown</span>
                        </button>
                        <ul class="dropdown-menu" id="inputLanguageDropdown">
                            <li><a href="#">æ—¥æœ¬èª</a></li>
                            <li><a href="#">English</a></li>
                            <li><a href="#">ä¸­æ–‡</a></li>
                            <li><a href="#">á€™á€¼á€”á€ºá€™á€¬á€˜á€¬á€á€¬</a></li>
                        </ul>
                    </div>
                </li>
                <li>
                    <div class="btn-group">
                        <button type="button" class="btn btn-info" id="outputLanguageButton">å‡ºåŠ›è¨€èª</button>
                        <button type="button" class="btn btn-info dropdown-toggle" data-toggle="dropdown"
                                aria-haspopup="true" aria-expanded="false">
                            <span class="caret"></span>
                            <span class="sr-only">Toggle Dropdown</span>
                        </button>
                        <ul class="dropdown-menu" id="outputLanguageDropdown">
                            <li><a href="#">æ—¥æœ¬èª</a></li>
                            <li><a href="#">English</a></li>
                            <li><a href="#">ä¸­æ–‡</a></li>
                            <li><a href="#">á€”á€ºá€™á€¬á€˜á€¬á€á€¬</a></li>
                        </ul>
                    </div>
                </li>
                <li>ã‹ ã‚‰: <input class="btn-info" type="date" id="startDate"></li>
                <li>ã¾ ã§: <input class="btn-info" type="date" id="endDate"></li>
            </ul>
            <ul>
                <li>
                    <button type="button" class="btn btn-info" id="ascendingOrderButton">å‡åº</button>
                    <button type="button" class="btn btn-info" id="descendingOrderButton">é™åº</button>

                </li>
                <li>
                    <button type="button" class="btn btn-info" id="showFavoritesButton" value="0">â™¥ã„ã„ã­â™¥</button>
                </li>
                <li>
                    <div class="row">
                        <div class="input-group">
                            <input type="text" class="form-control" id="searchInput" placeholder="Search for...">
                            <span class="input-group-btn">
                                    <button class="btn btn-default" type="button" id="searchButton">ç¢ºèª</button>
                            </span>
                        </div>
                    </div>
                </li>
                <li>
                    <button type="button" class="btn btn-danger" id="resetButton">é‡æ–°è®¾å®š</button>
                </li>
            </ul>
        </div>
        <div style="margin-bottom: 10px">
            <!-- æäº¤æŒ‰é’® -->
            <button id="submitButton" class="btn btn-success">
                <span class="glyphicon glyphicon-plus-sign" aria-hidden="true"></span> æäº¤
            </button>
        </div>
    </div>
    <div class="bs-example" data-example-id="bordered-table">
        <div class="panel panel-default">
            <div class="panel-heading"><span class="glyphicon glyphicon-th" aria-hidden="true"> </span>
                History List
            </div>

            <table class="table table-bordered">
                <thead>
                <tr class="active">
                    <th>ID</th>
                    <th>çŸ¥ã‚ŠãŸã„å˜èª</th>
                    <th>ç¿»è¨³ã—ãŸå˜èª</th>
                    <th>æœ€çµ‚ã‚¯ã‚¨ãƒªæ™‚é–“</th>
                    <th>æ“ä½œ</th>
                </tr>
                </thead>
                <tbody>
                {% for item in data_list %}
                    <tr class="{% if loop.index is even %}success{% else %}active{% endif %}">
                        <td>{{ item.id }}</td>
                        <td>{{ item.inputlanguage }}</td>
                        <td>{{ item.inputtext }}</td>
                        <td>{{ item.outputlanguage }}</td>
                        <td>{{ item.outputtext }}</td>
                        <td>
                            <div class="btn-container">
                                <form method="POST" action="/update_translation_item"> <!-- æ›¿æ¢æˆå¤„ç†æ›´æ–°çš„è·¯ç”± -->
                                    <input type="hidden" name="nid" value="{{ item.id }}">
                                    <button type="submit" class="btn btn-primary btn-xs">ğŸ¤</button>
                                </form>
                                <form method="POST" action="/delete_translation_list">
                                    <input type="hidden" name="nid" value="{{ item.id }}">
                                    <button type="submit" class="btn btn-danger btn-xs">åˆ é™¤</button>
                                </form>
                            </div>

                        </td>
                        <td>{{ item.updatetime }}</td>
                    </tr>
                {% endfor %}

                </tbody>
            </table>

        </div>
        <nav aria-label="Page navigation">
            <ul class="pagination" id="pagination">
                <!-- åˆ†é¡µæŒ‰é’®å°†åœ¨è¿™é‡ŒåŠ¨æ€ç”Ÿæˆ -->
            </ul>
        </nav>

    </div>


</div>
<script>
    document.addEventListener("DOMContentLoaded", function () {
        // åˆå§‹åŒ–å˜é‡ç”¨äºå­˜å‚¨ç”¨æˆ·çš„é€‰æ‹©
        let selectedInputLanguage = null;
        let selectedOutputLanguage = null;
        let selectedStartDate = null;
        let selectedEndDate = null;
        let sortOrder = 0; // é»˜è®¤æ˜¯å‡åº
        let searchKeyword = ""; // åˆå§‹åŒ–å˜é‡
        let showFavoritesValue = "0"; // åˆå§‹åŒ–ä¸º "0"
        // å‡è®¾è¿™äº›æ˜¯ä»åç«¯è·å–çš„æ•°æ®ï¼Œæ ¹æ®å®é™…æƒ…å†µä¿®æ”¹
        const totalDataCount = 100; // æ›¿æ¢æˆå®é™…çš„æ€»æ•°æ®é‡
        const itemsPerPage = 10; // æ›¿æ¢æˆå®é™…çš„æ¯é¡µæ˜¾ç¤ºçš„æ•°æ®é‡


        // è·å–ä¸‹æ‹‰èœå•å…ƒç´ 
        const inputLanguageDropdown = document.getElementById("inputLanguageDropdown");
        const outputLanguageDropdown = document.getElementById("outputLanguageDropdown");

        // è·å–æ—¥æœŸé€‰æ‹©æŒ‰é’®å…ƒç´ 
        const startDate = document.getElementById("startDate");
        const endDate = document.getElementById("endDate");

        // è·å–æ’åºæŒ‰é’®å…ƒç´ 
        const ascendingOrderButton = document.getElementById("ascendingOrderButton");
        const descendingOrderButton = document.getElementById("descendingOrderButton");

        // è·å–æœç´¢æŒ‰é’®å’Œè¾“å…¥æ¡†å…ƒç´ 
        const searchButton = document.getElementById("searchButton");
        const searchInput = document.getElementById("searchInput");

        // è·å–æ˜¾ç¤ºæ”¶è—æŒ‰é’®çš„å€¼
        const showFavoritesButton = document.getElementById("showFavoritesButton");
        showFavoritesButton.addEventListener("click", function () {
            if (showFavoritesValue === "0") {
                showFavoritesValue = "1"; // åˆ‡æ¢å€¼ï¼Œ0 è¡¨ç¤ºä¸æ˜¾ç¤ºï¼Œ1 è¡¨ç¤ºæ˜¾ç¤º
            } else {
                showFavoritesValue = "0";
            }
        });

        // æ·»åŠ ä¸‹æ‹‰èœå•ç‚¹å‡»äº‹ä»¶ç›‘å¬å™¨
        inputLanguageDropdown.addEventListener("click", function (event) {
            selectedInputLanguage = event.target.textContent;
        });

        outputLanguageDropdown.addEventListener("click", function (event) {
            selectedOutputLanguage = event.target.textContent;
        });

        // æ·»åŠ æ—¥æœŸé€‰æ‹©äº‹ä»¶ç›‘å¬å™¨
        startDate.addEventListener("change", function (event) {
            selectedStartDate = event.target.value;
        });

        endDate.addEventListener("change", function (event) {
            selectedEndDate = event.target.value;
        });

        // æ·»åŠ æ’åºæŒ‰é’®ç‚¹å‡»äº‹ä»¶ç›‘å¬å™¨
        ascendingOrderButton.addEventListener("click", function () {
            sortOrder = 0; // 0 è¡¨ç¤ºå‡åº
        });

        descendingOrderButton.addEventListener("click", function () {
            sortOrder = 1; // 1 è¡¨ç¤ºé™åº
        });

        // æ·»åŠ æœç´¢æŒ‰é’®ç‚¹å‡»äº‹ä»¶ç›‘å¬å™¨
        searchButton.addEventListener("click", function () {
            searchKeyword = searchInput.value;
            // å…¶ä»–æ“ä½œ...
        });

        //é‡ç½®æŒ‰é’®çš„æœºèƒ½
        // è·å–é‡ç½®æŒ‰é’®å…ƒç´ 
        const resetButton = document.getElementById("resetButton");

        // æ·»åŠ é‡ç½®æŒ‰é’®ç‚¹å‡»äº‹ä»¶ç›‘å¬å™¨
        resetButton.addEventListener("click", function () {
            // å°†æ‰€æœ‰é€‰é¡¹æ¢å¤ä¸ºé»˜è®¤çŠ¶æ€
            selectedInputLanguage = null;
            selectedOutputLanguage = null;
            selectedStartDate = null;
            selectedEndDate = null;
            sortOrder = 0; // æ¢å¤ä¸ºå‡åº
            showFavoritesValue = "0"; // æ¢å¤ä¸ºä¸æ˜¾ç¤º
            searchKeyword = ""; // æ¢å¤æœç´¢å…³é”®è¯ä¸ºé»˜è®¤å€¼

            // æ¸…ç©ºä¸‹æ‹‰èœå•é€‰æ‹©
            inputLanguageDropdown.querySelectorAll("a").forEach((item) => {
                item.classList.remove("selected");
            });
            outputLanguageDropdown.querySelectorAll("a").forEach((item) => {
                item.classList.remove("selected");
            });

            // æ¸…ç©ºæ—¥æœŸé€‰æ‹©
            startDate.value = "";
            endDate.value = "";

            // æ¢å¤æ’åºæŒ‰é’®çŠ¶æ€
            ascendingOrderButton.classList.remove("selected");
            descendingOrderButton.classList.remove("selected");

            // æ¸…ç©ºæœç´¢è¾“å…¥æ¡†
            searchInput.value = searchKeyword;

            // æ›´æ–°æ˜¾ç¤ºæ”¶è—æŒ‰é’®çŠ¶æ€
            showFavoritesButton.value = "0";
        });
        // è·å–åˆ†é¡µæ å…ƒç´ 
        const pagination = document.getElementById("pagination");

        // å‡è®¾è¿™é‡Œæœ‰ä¸€ä¸ªå˜é‡ totalPages åŒ…å«äº†åç«¯è¿”å›çš„æ€»é¡µæ•°
        const totalPages = Math.ceil(totalDataCount / itemsPerPage);


        // æ¸…ç©ºåˆ†é¡µæ 
        pagination.innerHTML = '';

        // åŠ¨æ€ç”Ÿæˆåˆ†é¡µæŒ‰é’®
        for (let page = 1; page <= totalPages; page++) {
            const pageButton = document.createElement("li");
            pageButton.innerHTML = `<a href="#">${page}</a>`;
            pagination.appendChild(pageButton);
        }


        // è·å–æäº¤æŒ‰é’®å…ƒç´ 
        const submitButton = document.getElementById("submitButton");


        // é¦–å…ˆç¡®ä¿æ–‡æ¡£å·²åŠ è½½å®Œæ¯•
        document.addEventListener('DOMContentLoaded', function () {
            // è¿™é‡Œæ·»åŠ ä½ çš„ä»£ç 

            // å½“ç”¨æˆ·é€‰æ‹©è¾“å…¥è¯­è¨€åè§¦å‘çš„äº‹ä»¶å¤„ç†ç¨‹åº
            document.getElementById('inputLanguageSelect').addEventListener('change', function () {
                const selectedInputLanguage = this.value; // è·å–ç”¨æˆ·é€‰æ‹©çš„è¾“å…¥è¯­è¨€
                const inputLanguageId = languageMapping[selectedInputLanguage]; // æ˜ å°„ä¸ºæ•°å­—å€¼
                // å°† inputLanguageId å‘é€åˆ°åç«¯ï¼Œå¯ä»¥ä½¿ç”¨ AJAX æˆ– Fetch API
            });

            // å½“ç”¨æˆ·é€‰æ‹©è¾“å‡ºè¯­è¨€åè§¦å‘çš„äº‹ä»¶å¤„ç†ç¨‹åº
            document.getElementById('outputLanguageSelect').addEventListener('change', function () {
                const selectedOutputLanguage = this.value; // è·å–ç”¨æˆ·é€‰æ‹©çš„è¾“å‡ºè¯­è¨€
                const outputLanguageId = languageMapping[selectedOutputLanguage]; // æ˜ å°„ä¸ºæ•°å­—å€¼
                // å°† outputLanguageId å‘é€åˆ°åç«¯ï¼Œå¯ä»¥ä½¿ç”¨ AJAX æˆ– Fetch API
            });
        });

        // åœ¨æäº¤æŒ‰é’®ç‚¹å‡»äº‹ä»¶å¤„ç†ç¨‹åºä¸­æ·»åŠ è·å–æ•°æ®çš„é€»è¾‘
        submitButton.addEventListener("click", function () {
            // æ„å»ºæ•°æ®å¯¹è±¡
            const requestData = {
                input_language: languageMapping[selectedInputLanguage],
                output_language: languageMapping[selectedOutputLanguage],
                start_date: selectedStartDate,
                end_date: selectedEndDate,
                sort_order: sortOrder,
                favoritesValue: showFavoritesValue,
                search_keyword: searchKeyword,
            };

            // ä½¿ç”¨fetchå°†æ•°æ®å¯¹è±¡å‘é€åˆ°åç«¯
            fetch("/user_translate_history", {
                method: "POST",
                headers: {
                    "Content-Type": "application/json",
                },
                body: JSON.stringify(requestData),
            })
                .then((response) => {
                    // åœ¨è¿™é‡Œå¤„ç†åç«¯çš„å“åº”
                    if (response.status === 200) {
                        return response.json();
                    }
                })
                // åœ¨æäº¤æŒ‰é’®ç‚¹å‡»äº‹ä»¶å¤„ç†ç¨‹åºä¸­çš„fetchæˆåŠŸåçš„å¤„ç†ä¸­
                .then((data) => {
                    // åœ¨è¿™é‡Œå¤„ç†ä»åç«¯è·å–çš„æ•°æ®
                    if (data.data_list !== null) {
                        // å¤„ç†æ•°æ®åˆ—è¡¨
                        console.log("æ•°æ®åˆ—è¡¨:", data.data_list);

                        // è¿™é‡Œå¯ä»¥å°†æ•°æ®æ˜¾ç¤ºåœ¨é¡µé¢ä¸Šï¼Œä¾‹å¦‚æ›´æ–°è¡¨æ ¼å†…å®¹
                        updateTableWithData(data.data_list, data.total_pages, data.current_page);

                        // æ›´æ–°åˆ†é¡µä¿¡æ¯
                        updatePagination(data.total_pages, data.current_page);
                    } else {
                        console.log("æœªæ‰¾åˆ°æœ‰æ•ˆçš„æ•°æ®åˆ—è¡¨ã€‚");
                    }
                })


        });

        function updateTableWithData(dataList, totalPages, currentPage) {
            // åœ¨è¿™é‡Œæ ¹æ®åç«¯è¿”å›çš„æ•°æ®åˆ—è¡¨æ›´æ–°è¡¨æ ¼å†…å®¹
            const tableBody = document.querySelector("table tbody");
            tableBody.innerHTML = "";  // æ¸…ç©ºè¡¨æ ¼å†…å®¹

            dataList.forEach((item, index) => {
                const tableRow = document.createElement("tr");
                tableRow.className = index % 2 === 0 ? "success" : "active";

                // æ ¹æ®éœ€è¦æ˜¾ç¤ºçš„åˆ—åˆ›å»ºå¯¹åº”çš„ <td> å…ƒç´ 
                const columnsToShow = [0, 1, 2, 3]; // é€‰æ‹©è¦æ˜¾ç¤ºçš„åˆ—çš„ç´¢å¼•
                columnsToShow.forEach(colIndex => {
                    const tableData = document.createElement("td");
                    tableData.textContent = item[colIndex];
                    tableRow.appendChild(tableData);
                });

                // æ·»åŠ æ“ä½œåˆ—
                const operationCell = document.createElement("td");
                const btnContainer = document.createElement("div");
                btnContainer.className = "btn-container";

                const updateForm = document.createElement("form");
                updateForm.method = "POST";
                updateForm.action = "/update_translation_item";
                const updateButton = createButton("ğŸ¤", "btn btn-primary btn-xs");

                const deleteForm = document.createElement("form");
                deleteForm.method = "POST";
                deleteForm.action = "/delete_translation_list";
                const deleteButton = createButton("åˆ é™¤", "btn btn-danger btn-xs");

                const hiddenInput = document.createElement("input");
                hiddenInput.type = "hidden";
                hiddenInput.name = "nid";
                hiddenInput.value = item[0];

                updateForm.appendChild(hiddenInput);
                deleteForm.appendChild(hiddenInput.cloneNode());

                btnContainer.appendChild(updateForm);
                btnContainer.appendChild(deleteForm);
                btnContainer.appendChild(updateButton);
                btnContainer.appendChild(deleteButton);

                operationCell.appendChild(btnContainer);
                tableRow.appendChild(operationCell);

                tableBody.appendChild(tableRow);
            });

            // æ›´æ–°åˆ†é¡µä¿¡æ¯
            updatePagination(totalPages, currentPage);
        }

// æ–°å¢ä¸€ä¸ªå‡½æ•°ç”¨äºåˆ›å»ºæŒ‰é’®å…ƒç´ 
        function createButton(text, className) {
            const button = document.createElement("button");
            button.type = "submit";
            button.className = className;
            button.textContent = text;
            return button;
        }

        // ä¸ºæ›´æ–°æŒ‰é’®å’Œåˆ é™¤æŒ‰é’®æ·»åŠ äº‹ä»¶ç›‘å¬å™¨
        const tableBody = document.querySelector("table tbody");

        tableBody.addEventListener("click", function (event) {
            const target = event.target;

            // ç¡®ä¿ç‚¹å‡»çš„æ˜¯æŒ‰é’®
            if (target.tagName === "BUTTON") {
                const row = target.closest("tr"); // è·å–æ‰€åœ¨è¡Œ
                const itemId = row.querySelector("input[name='nid']").value; // è·å–è¡Œçš„ID
                console.log("idæ˜¯" + itemId)

                if (target.classList.contains("btn-primary")) {
                    // ç‚¹å‡»äº†æ›´æ–°æŒ‰é’®
                    // åœ¨è¿™é‡Œæ·»åŠ å°†è¡Œæ ‡è®°ä¸ºå·²å˜æ›´å¹¶å‘åå°å‘é€IDçš„é€»è¾‘
                    target.textContent = "â™¥ã„ã„ã­â™¥";
                    target.disabled = true;

                    // å‘åå°å‘é€è¯·æ±‚ï¼Œå¯ä»¥ä½¿ç”¨ fetch æˆ–å…¶ä»–é€‚å½“çš„æ–¹æ³•
                    // ä¾‹å¦‚ï¼š
                    fetch("/mark_item_updated", {
                        method: "POST",
                        headers: {
                            "Content-Type": "application/json",
                        },
                        body: JSON.stringify({id: itemId}), // ä½¿ç”¨æ­£ç¡®çš„å­—æ®µå
                    })
                        .then(response => {
                            if (response.status === 200) {
                                console.log("è¡Œæ ‡è®°ä¸ºå·²å˜æ›´");
                            }
                        })
                        .catch(error => {
                            console.error("å‘ç”Ÿé”™è¯¯:", error);
                        });
                } else if (target.classList.contains("btn-danger")) {
                    // ç‚¹å‡»äº†åˆ é™¤æŒ‰é’®
                    // åœ¨è¿™é‡Œæ·»åŠ åˆ é™¤è¡Œçš„é€»è¾‘
                    row.remove(); // åˆ é™¤å½“å‰è¡Œ

                    // å‘åå°å‘é€è¯·æ±‚ï¼Œå¯ä»¥ä½¿ç”¨ fetch æˆ–å…¶ä»–é€‚å½“çš„æ–¹æ³•
                    // ä¾‹å¦‚ï¼š
                    fetch("/delete_item", {
                        method: "POST",
                        headers: {
                            "Content-Type": "application/json",
                        },
                        body: JSON.stringify({id: itemId}), // ä½¿ç”¨æ­£ç¡®çš„å­—æ®µå
                    })
                        .then(response => {
                            if (response.status === 200) {
                                console.log("è¡Œå·²åˆ é™¤");
                            }
                        })
                        .catch(error => {
                            console.error("å‘ç”Ÿé”™è¯¯:", error);
                        });
                }
            }
        });

// æ–°å¢ä¸€ä¸ªå‡½æ•°ç”¨äºæ›´æ–°åˆ†é¡µä¿¡æ¯
        function updatePagination(totalPages, currentPage) {
            const pagination = document.getElementById("pagination");
            pagination.innerHTML = "";
            for (let i = 1; i <= totalPages; i++) {
                const li = document.createElement("li");
                li.className = i === currentPage ? "active" : "";
                const link = document.createElement("a");
                link.href = "#"; // å¯ä»¥æ·»åŠ ä½ çš„åˆ†é¡µå¤„ç†é€»è¾‘
                link.textContent = i;
                link.addEventListener("click", () => handlePageClick(i)); // æ·»åŠ ç‚¹å‡»äº‹ä»¶å¤„ç†é€»è¾‘

                li.appendChild(link);
                pagination.appendChild(li);
            }
        }

// æ–°å¢ä¸€ä¸ªå‡½æ•°ç”¨äºå¤„ç†åˆ†é¡µæŒ‰é’®ç‚¹å‡»äº‹ä»¶
        function handlePageClick(pageNumber) {
            // åœ¨è¿™é‡Œå¯ä»¥å¤„ç†ç‚¹å‡»åˆ†é¡µæŒ‰é’®çš„é€»è¾‘
            // ä¾‹å¦‚ï¼Œå¯ä»¥å‘èµ·åç«¯è¯·æ±‚è·å–å¯¹åº”é¡µçš„æ•°æ®ï¼Œç„¶åè°ƒç”¨ updateTableWithData æ›´æ–°è¡¨æ ¼å†…å®¹
            console.log("Clicked on page", pageNumber);

            // æ„å»ºæ•°æ®å¯¹è±¡
            const requestData = {
                input_language: selectedInputLanguage,
                output_language: selectedOutputLanguage,
                start_date: selectedStartDate,
                end_date: selectedEndDate,
                sort_order: sortOrder,
                favoritesValue: showFavoritesValue,
                search_keyword: searchKeyword,
                page: pageNumber, // å°†ç‚¹å‡»çš„é¡µç ä¼ é€’åˆ°åç«¯
            };

            // ä½¿ç”¨ fetch å°†æ•°æ®å¯¹è±¡å‘é€åˆ°åç«¯
            fetch("/user_translate_history", {
                method: "POST",
                headers: {
                    "Content-Type": "application/json",
                },
                body: JSON.stringify(requestData),
            })
                .then((response) => {
                    // åœ¨è¿™é‡Œå¤„ç†åç«¯çš„å“åº”
                    if (response.status === 200) {
                        return response.json();
                    }
                })
                // åœ¨ fetch æˆåŠŸåçš„å¤„ç†ä¸­
                .then((data) => {
                    // åœ¨è¿™é‡Œå¤„ç†ä»åç«¯è·å–çš„æ•°æ®
                    if (data.data_list !== null) {
                        // å¤„ç†æ•°æ®åˆ—è¡¨
                        console.log("æ•°æ®åˆ—è¡¨:", data.data_list);

                        // è¿™é‡Œå¯ä»¥å°†æ•°æ®æ˜¾ç¤ºåœ¨é¡µé¢ä¸Šï¼Œä¾‹å¦‚æ›´æ–°è¡¨æ ¼å†…å®¹
                        updateTableWithData(data.data_list, data.total_pages, data.current_page);
                    } else {
                        console.log("æœªæ‰¾åˆ°æœ‰æ•ˆçš„æ•°æ®åˆ—è¡¨ã€‚");
                    }
                })
        }
    });

</script>
<script src="/static/plugins/jquery-3.6.0.min.js"></script>
<script src="/static/plugins/bootstrap-3.4.1/bootstrap-3.4.1-dist/js/bootstrap.js"></script>
</body>
</html>
